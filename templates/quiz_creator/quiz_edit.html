{% extends "base.html" %}
{% block content %}

<h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã: {{ quiz.title }}</h2>

<h3>–î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å</h3>
<form method="post">
  {% csrf_token %}
  <textarea name="question" placeholder="–í–æ–ø—Ä–æ—Å" required></textarea><br><br>

  <div id="answers">
    <div class="answer">
      <input type="text" name="answer_text" placeholder="–û—Ç–≤–µ—Ç" required>
      <input type="checkbox" name="is_correct" value="0"> –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π
    </div>
  </div>

  <button type="button" onclick="addAnswer()"> + –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç</button>
  <button type="button" onclick="removeLastAnswer()"> - –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–≤–µ—Ç</button>
  <br><br>

  <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</form>

<hr>

<h3>–£–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
{% for question in questions %}
  <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
    <p><strong>{{ forloop.counter }}. {{ question.text }}</strong></p>
    <ul>
      {% for answer in question.answers.all %}
        <li>
          {{ answer.text }} {% if answer.is_correct %}‚úÖ{% endif %}
        </li>
      {% endfor %}
    </ul>
    <form method="post" action="{% url 'question_delete' quiz.id question.id %}">
      {% csrf_token %}
      <button type="submit">üóë –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
    </form>
  </div>
{% empty %}
  <p>–ü–æ–∫–∞ –Ω–µ—Ç –≤–æ–ø—Ä–æ—Å–æ–≤.</p>
{% endfor %}

<hr>

<form method="post" action="{% url 'quiz_finish' quiz.id %}">
  {% csrf_token %}
  <button type="submit">‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ</button>
</form>

<script>
  let answerCount = 1;
  function addAnswer() {
    const container = document.getElementById('answers');

    const answerDiv = document.createElement('div');
    answerDiv.classList.add('answer');

    const input = document.createElement('input');
    input.type = 'text';
    input.name = 'answer_text';
    input.placeholder = '–û—Ç–≤–µ—Ç';
    input.required = true;

    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.name = 'is_correct';
    checkbox.value = answerCount;

    const label = document.createElement('label');
    label.innerText = ' –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π';

    answerDiv.appendChild(input);
    answerDiv.appendChild(checkbox);
    answerDiv.appendChild(label);

    container.appendChild(answerDiv);
    answerCount++;
  }

  function removeLastAnswer() {
    const container = document.getElementById('answers');
    if (container.children.length > 1) {
      container.removeChild(container.lastElementChild);
      answerCount--;
    }
  }
</script>

{% endblock %}